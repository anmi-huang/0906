"use strict";function createProductCard(t,e){return'\n  <li class="col-md-6 mb-3 ">\n    <div class="card border border-secondary">\n        <a href="#" class="text-decoration-none ">\n            <div>\n                <img src="'.concat(t.imgUrl,'" class="img-card d-block position-relative w-100">\n            </div>\n            <div class="card-span position-absolute fz-16px">\n                <span class=" text-white fz-16px px-1 py-1">本日精選</span>\n            </div>\n            <div class="d-flex text-center text-primary fz-18px fz-md-20px">\n                <div class="flex-grow-1  ff-ping-fang-tc-light text-cart-font border border-secondary  border-right-0  border-left-0 py-1">').concat(t.itemName,'</div>\n                <div class="flex-grow-1  ff-ping-fang-tc-semibold border-secondary border border-right-0 py-1 ">NT$ ').concat(t.price,'</div>\n            </div>\n        </a>\n    \t<button id="js-product-btn" data-addbtn="').concat(e,'"  data-cart="').concat(t.id,'" class="js-product-row add-item-tr fz-22px fz-md-28px btn-add bg-secondary text-center text-primary w-100 py-2"id="btn-cart" >\n    \t\t\t加入購物車\n    \t</button>\n        <div class="btn-card position-absolute ">\n            <button >\n                <i class="far fa-heart fz-22px text-primary"></i>\n            </button>\n        </div>\n    </div>\n  </li>\n    ')}function Cart(){this.key="example-cart",this.itemList=[],this.initCart=function(){var t=localStorage.getItem(this.key);t&&(this.itemList=JSON.parse(t)),this.render()},this.addItem=function(t,e){var n=this.itemList,i=productsData[t],r=n.findIndex(function(t){return t.id===e});if(n[r])n[r].amount+=1;else{var c=i;c.amount=1,this.itemList.push(c)}this.updateDataToStorage(),this.cartNumberRender()},this.btnAddItem=function(t){document.querySelector("#js-count-".concat(t)).innerHTML=++this.itemList[t].amount,this.updateDataToStorage(),this.countRender(t)},this.btnMinuserItem=function(t){this.itemList[t].amount<=1||(document.querySelector("#js-count-".concat(t)).innerHTML=--this.itemList[t].amount,this.updateDataToStorage(),this.countRender(t))},this.deleteItem=function(t,e){document.querySelector("#js-item-".concat(t)).remove();var n=this.itemList.findIndex(function(t){return t.id===e});this.itemList.splice(n,1),this.updateTotal(),this.cartNumberRender(),this.updateDataToStorage()},this.updateDataToStorage=function(){var t=JSON.stringify(this.itemList);localStorage.setItem(this.key,t)},this.updateTotal=function(){var t=0,e=0,n=300;this.itemList.forEach(function(i){var r=i.price*i.amount;t+=r,e=t+n}),jsTotal.innerHTML="NT$ ".concat(t),jsFee.innerHTML="NT$ ".concat(n),jsSum.innerHTML="NT$ ".concat(e)},this.countRender=function(t){document.querySelector("#js-value-".concat(t)).innerHTML="NT$ ".concat(this.itemList[t].amount*this.itemList[t].price),this.updateTotal()},this.cartNumberRender=function(){cartNumber.innerHTML='\n        <span class="cart-number-size rounded-circle w-5 h-5 position-absolute text-center text-primary bg-secondary fz-24"> \n        '.concat(this.itemList.length,"\n         </span>\n         ")},this.render=function(){this.cartNumberRender();var t,e,n=0,i=0,r=300;this.itemList.forEach(function(c,a){var o=c.price*c.amount;n+=o,i=n+r;var s='   \n         <li id="js-item-'.concat(a,'" class=" row g-0 col-md-12 mb-2 pb-2 mx-0 px-0 border-cart border-secondary text-primary align-items-center  justify-content-between ff-ping-fang-tc-semibold  ">\n               \n            <div class="col-6 col-md-3 pl-0">\n                <img src="').concat(c.imgUrl,'" class="cart-img w-100 ">\n            </div>\n\n            <div class=" row g-0 col-6 col-md-6 ff-ping-fang-tc-light align-items-center">\n                <div class="col-md-6 ">\n                    <div class="fz-20px">').concat(c.itemName,'</div>\n                    <div class="ff-Helvetica-neue-regular py-2px">NT$ ').concat(c.price,'</div>\n                </div>\n\n                <div class="col-md-6 d-flex  ">\n                    <button  data-minuser="').concat(a,'" class=" js-minuser  w-6 h-6 ff-ping-fang-tc-light border border-right-0 text-center btn-active"><i class="icon icon-minus text-primary pointer-events-none"></i></button>\n                    <div id="js-count-').concat(a,'" class="d-flex justify-content-center align-items-center w-6 h-6 ff-ping-fang-tc-light border border-right-0">').concat(c.amount,'</div>\n                    <button  data-adder="').concat(a,'" class=" js-adder  w-6 h-6 ff-ping-fang-tc-light  border text-center btn-active"><i class="icon icon-add text-primary pointer-events-none"></i></button></button> \n                </div>   \n            </div>\n\n            <div class="col-12 col-md-3 d-flex  px-0"> \n                    <div  id="js-value-').concat(a,'" class="price-border col-md-10 fz-20px py-1 border border-secondary border-right-0 border-left-0  text-right text-md-left ">\n                    NT$ ').concat(o,'\n                    </div>\n                    <button id="js-btn" class="col-md-2 d-none d-md-block text-right px-1" data-btn="').concat(a,'" data-pid="').concat(c.id,'" ><img src="./img/trash.svg" alt=""class="pointer-events-none w-2">\n                    </button>\n            </div> \n        </li>\n        '),d='\n             <li id="js-item-'.concat(a,'" class=" row g-0 mx-0 px-0 col-md-12  align-items-center ff-ping-fang-tc-semibold  ">\n                <div class="col-md-6 ">\n                    <img src="').concat(c.imgUrl,'" class="cart-img w-100 h-10 px-2">\n                </div>\n                <div class=" row g-0 col-md-6 ff-ping-fang-tc-light ">\n                    <div>\n                        <div class="fz-16px">').concat(c.itemName,"&nbsp; (").concat(c.amount,')</div>\n                        <div id="js-value-').concat(a,'" class="fz-20px text-left">NT$ ').concat(o,"</div>\n                    </div>\n                </div>\n            </li>\n        ");t=s,cartList&&(cartList.innerHTML+=t),e=d,shoppingList&&(shoppingList.innerHTML+=e)}),cartOrder&&(jsTotal.innerHTML="NT$ ".concat(n),jsFee.innerHTML="NT$ ".concat(r),jsSum.innerHTML="NT$ ".concat(i))}}var productsData,citiesData,jsTotal=document.querySelector("#js-total"),jsFee=document.querySelector("#js-fee"),jsSum=document.querySelector("#js-sum"),cartNumber=document.querySelector("#cart-number"),cartOrder=document.querySelector("#cart-order"),cartList=document.querySelector("#cart-list"),jsProductRow=document.querySelector(".js-product-row"),productRow=document.querySelector("#product-row"),jsProductBtn=document.querySelector("#js-product-btn"),shoppingList=document.querySelector("#shopping-list");productRow&&fetch("api/dessert.json").then(function(t){return t.json()}).then(function(t){var e=t.products;productsData=e;var n=" ";productsData.forEach(function(t,e){var i=createProductCard(t,e);n+=i}),productRow&&(productRow.innerHTML=n),productRow.addEventListener("click",function(t){if(t.target.dataset.addbtn){var e=1*t.target.dataset.cart;cart.addItem(t.target.dataset.addbtn,e)}})});var cart=new Cart;cart.initCart(),cartList&&cartList.addEventListener("click",function(t){var e,n=t.target;if(n.matches(".js-adder")&&(e=n.dataset.adder,cart.btnAddItem(e)),n.matches(".js-minuser")&&(e=n.dataset.minuser,cart.btnMinuserItem(e)),n.matches("#js-btn")){var i=confirm("確定要刪除嗎？");e=n.dataset.btn;var r=1*n.dataset.pid;i&&cart.deleteItem(e,r)}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdsb2JhbC5qcyJdLCJuYW1lcyI6WyJjcmVhdGVQcm9kdWN0Q2FyZCIsInByb2R1Y3QiLCJpbmRleCIsImNvbmNhdCIsImltZ1VybCIsIml0ZW1OYW1lIiwicHJpY2UiLCJpZCIsIkNhcnQiLCJ0aGlzIiwia2V5IiwiaXRlbUxpc3QiLCJpbml0Q2FydCIsImxvY2FsRGF0YVN0cmluZyIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJKU09OIiwicGFyc2UiLCJyZW5kZXIiLCJhZGRJdGVtIiwiaWR4IiwicGlkIiwibGlzdCIsInByb2R1Y3RzRGF0YSIsImZpbmRJZHgiLCJmaW5kSW5kZXgiLCJpdGVtIiwiYW1vdW50IiwicHVzaCIsInVwZGF0ZURhdGFUb1N0b3JhZ2UiLCJjYXJ0TnVtYmVyUmVuZGVyIiwiYnRuQWRkSXRlbSIsImkiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJpbm5lckhUTUwiLCJjb3VudFJlbmRlciIsImJ0bk1pbnVzZXJJdGVtIiwiZGVsZXRlSXRlbSIsInJlbW92ZSIsImlkeFJlbW92ZSIsInNwbGljZSIsInVwZGF0ZVRvdGFsIiwiZGF0YVN0cmluZyIsInN0cmluZ2lmeSIsInNldEl0ZW0iLCJjYXJ0VmFsdWUiLCJjYXJ0U3VtIiwiZmVlIiwiZm9yRWFjaCIsIml0ZW1WYWx1ZSIsImpzVG90YWwiLCJqc0ZlZSIsImpzU3VtIiwiY2FydE51bWJlciIsImxlbmd0aCIsInN0ciIsInNocFN0ciIsInRyIiwiY2FydExpc3QiLCJzaG9wcGluZ0xpc3QiLCJjYXJ0T3JkZXIiLCJjaXRpZXNEYXRhIiwianNQcm9kdWN0Um93IiwicHJvZHVjdFJvdyIsImpzUHJvZHVjdEJ0biIsImZldGNoIiwidGhlbiIsInJlc3AiLCJqc29uIiwiX3JlZiIsInByb2R1Y3RzIiwiY2FyZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwidGFyZ2V0IiwiZGF0YXNldCIsImFkZGJ0biIsImNhcnRJZCIsImNhcnQiLCJtYXRjaGVzIiwiYWRkZXIiLCJtaW51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QUt6QyxXQUFXcEMsRUFBTW1CIiwiZmlsZSI6ImFwcC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJsZXQgcHJvZHVjdHNEYXRhXG5sZXQgY2l0aWVzRGF0YVxuY29uc3QganNUb3RhbD1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjanMtdG90YWxgKVxuY29uc3QganNGZWU9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI2pzLWZlZWApXG5jb25zdCBqc1N1bT1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjanMtc3VtYClcbmNvbnN0IGNhcnROdW1iZXI9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI2NhcnQtbnVtYmVyYClcbmNvbnN0IGNhcnRPcmRlcj1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjY2FydC1vcmRlcmApXG5jb25zdCBjYXJ0TGlzdD1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjY2FydC1saXN0YClcbmNvbnN0IGpzUHJvZHVjdFJvdz1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuanMtcHJvZHVjdC1yb3dgKVxuY29uc3QgcHJvZHVjdFJvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwcm9kdWN0LXJvdycpXG5jb25zdCBqc1Byb2R1Y3RCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjanMtcHJvZHVjdC1idG4nKVxuY29uc3Qgc2hvcHBpbmdMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Nob3BwaW5nLWxpc3QnKVxuXG5mdW5jdGlvbiBjcmVhdGVQcm9kdWN0Q2FyZChwcm9kdWN0LGluZGV4KSB7XG4gICAgcmV0dXJuIGBcbiAgPGxpIGNsYXNzPVwiY29sLW1kLTYgbWItMyBcIj5cbiAgICA8ZGl2IGNsYXNzPVwiY2FyZCBib3JkZXIgYm9yZGVyLXNlY29uZGFyeVwiPlxuICAgICAgICA8YSBocmVmPVwiI1wiIGNsYXNzPVwidGV4dC1kZWNvcmF0aW9uLW5vbmUgXCI+XG4gICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgIDxpbWcgc3JjPVwiJHtwcm9kdWN0LmltZ1VybH1cIiBjbGFzcz1cImltZy1jYXJkIGQtYmxvY2sgcG9zaXRpb24tcmVsYXRpdmUgdy0xMDBcIj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNhcmQtc3BhbiBwb3NpdGlvbi1hYnNvbHV0ZSBmei0xNnB4XCI+XG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCIgdGV4dC13aGl0ZSBmei0xNnB4IHB4LTEgcHktMVwiPuacrOaXpeeyvumBuDwvc3Bhbj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImQtZmxleCB0ZXh0LWNlbnRlciB0ZXh0LXByaW1hcnkgZnotMThweCBmei1tZC0yMHB4XCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImZsZXgtZ3Jvdy0xICBmZi1waW5nLWZhbmctdGMtbGlnaHQgdGV4dC1jYXJ0LWZvbnQgYm9yZGVyIGJvcmRlci1zZWNvbmRhcnkgIGJvcmRlci1yaWdodC0wICBib3JkZXItbGVmdC0wIHB5LTFcIj4ke3Byb2R1Y3QuaXRlbU5hbWV9PC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImZsZXgtZ3Jvdy0xICBmZi1waW5nLWZhbmctdGMtc2VtaWJvbGQgYm9yZGVyLXNlY29uZGFyeSBib3JkZXIgYm9yZGVyLXJpZ2h0LTAgcHktMSBcIj5OVCQgJHtwcm9kdWN0LnByaWNlfTwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvYT5cbiAgICBcdDxidXR0b24gaWQ9XCJqcy1wcm9kdWN0LWJ0blwiIGRhdGEtYWRkYnRuPVwiJHtpbmRleH1cIiAgZGF0YS1jYXJ0PVwiJHtwcm9kdWN0LmlkfVwiIGNsYXNzPVwianMtcHJvZHVjdC1yb3cgYWRkLWl0ZW0tdHIgZnotMjJweCBmei1tZC0yOHB4IGJ0bi1hZGQgYmctc2Vjb25kYXJ5IHRleHQtY2VudGVyIHRleHQtcHJpbWFyeSB3LTEwMCBweS0yXCJpZD1cImJ0bi1jYXJ0XCIgPlxuICAgIFx0XHRcdOWKoOWFpeizvOeJqei7ilxuICAgIFx0PC9idXR0b24+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJidG4tY2FyZCBwb3NpdGlvbi1hYnNvbHV0ZSBcIj5cbiAgICAgICAgICAgIDxidXR0b24gPlxuICAgICAgICAgICAgICAgIDxpIGNsYXNzPVwiZmFyIGZhLWhlYXJ0IGZ6LTIycHggdGV4dC1wcmltYXJ5XCI+PC9pPlxuICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICA8L2xpPlxuICAgIGA7XG59XG5cbmZ1bmN0aW9uIENhcnQoKSB7XG4gICAgdGhpcy5rZXkgPSdleGFtcGxlLWNhcnQnO1xuICAgIHRoaXMuaXRlbUxpc3QgPSBbXTtcbiAgICB0aGlzLmluaXRDYXJ0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25zdCBsb2NhbERhdGFTdHJpbmcgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSh0aGlzLmtleSk7XG4gICAgICAgIGlmIChsb2NhbERhdGFTdHJpbmcpIHtcbiAgICAgICAgICAgIHRoaXMuaXRlbUxpc3QgPSBKU09OLnBhcnNlKGxvY2FsRGF0YVN0cmluZyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICB9XG5cbiAgICB0aGlzLmFkZEl0ZW0gPSBmdW5jdGlvbiAoaWR4LHBpZCkge1xuICAgICAgICAgIFxuICAgICAgICBsZXQgbGlzdD10aGlzLml0ZW1MaXN0XG4gICAgICAgIGNvbnN0IHByb2R1Y3Q9cHJvZHVjdHNEYXRhW2lkeF0gXG4gICAgICAgIGNvbnN0IGZpbmRJZHggPSBsaXN0LmZpbmRJbmRleCgoaXRlbSk9Pml0ZW0uaWQ9PT1waWQpXG4gICAgICAgIGlmIChsaXN0W2ZpbmRJZHhdKSB7XG4gICAgICAgICAgICBsaXN0W2ZpbmRJZHhdLmFtb3VudCs9MSBcbiAgICAgICAgfVxuICAgICAgICBlbHNle1xuICAgICAgICAgICAgY29uc3QgaXRlbT1wcm9kdWN0XG4gICAgICAgICAgICBpdGVtLmFtb3VudD0xXG4gICAgICAgICAgICB0aGlzLml0ZW1MaXN0LnB1c2goaXRlbSk7XG4gICAgICAgICAgICB9ICAgICAgICBcbiAgICB0aGlzLnVwZGF0ZURhdGFUb1N0b3JhZ2UoKTtcbiAgICB0aGlzLmNhcnROdW1iZXJSZW5kZXIoKTtcbn0gICBcbiAgICB0aGlzLmJ0bkFkZEl0ZW0gPSBmdW5jdGlvbiAoaSkge1xuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjanMtY291bnQtJHtpfWApLmlubmVySFRNTCA9Kyt0aGlzLml0ZW1MaXN0W2ldLmFtb3VudCBcbiAgICAgICAgdGhpcy51cGRhdGVEYXRhVG9TdG9yYWdlKCk7XG4gICAgICAgIHRoaXMuY291bnRSZW5kZXIoaSlcbiAgICB9XG4gICAgXG4gICAgdGhpcy5idG5NaW51c2VySXRlbSA9IGZ1bmN0aW9uIChpKSB7XG4gICAgICAgIGlmKHRoaXMuaXRlbUxpc3RbaV0uYW1vdW50PD0xKXtcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNqcy1jb3VudC0ke2l9YCkuaW5uZXJIVE1MID0tLXRoaXMuaXRlbUxpc3RbaV0uYW1vdW50IFxuICAgICAgICB0aGlzLnVwZGF0ZURhdGFUb1N0b3JhZ2UoKTtcbiAgICAgICAgdGhpcy5jb3VudFJlbmRlcihpKVxuICAgIH1cbiAgICBcbiAgICB0aGlzLmRlbGV0ZUl0ZW0gPSBmdW5jdGlvbiAoaSxwaWQpIHtcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI2pzLWl0ZW0tJHtpfWApLnJlbW92ZSgpXG4gICAgICAgIGNvbnN0IGlkeFJlbW92ZSA9IHRoaXMuaXRlbUxpc3QuZmluZEluZGV4KChpdGVtKT0+aXRlbS5pZD09PXBpZClcbiAgICAgICAgdGhpcy5pdGVtTGlzdC5zcGxpY2UoaWR4UmVtb3ZlLDEpO1xuICAgICAgICB0aGlzLnVwZGF0ZVRvdGFsKCk7XG4gICAgICAgIHRoaXMuY2FydE51bWJlclJlbmRlcigpO1xuICAgICAgICB0aGlzLnVwZGF0ZURhdGFUb1N0b3JhZ2UoKTtcbiAgICB9XG4gIFxuICAgIHRoaXMudXBkYXRlRGF0YVRvU3RvcmFnZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc3QgZGF0YVN0cmluZyA9IEpTT04uc3RyaW5naWZ5KHRoaXMuaXRlbUxpc3QpO1xuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSh0aGlzLmtleSwgZGF0YVN0cmluZyk7XG4gICAgfVxuXG4gICAgdGhpcy51cGRhdGVUb3RhbD1mdW5jdGlvbigpe1xuICAgICAgICBsZXQgY2FydFZhbHVlID0gMDtcbiAgICAgICAgbGV0IGNhcnRTdW0gPSAwO1xuICAgICAgICBsZXQgZmVlID0gMzAwO1xuICAgICAgICB0aGlzLml0ZW1MaXN0LmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgICAgY29uc3QgaXRlbVZhbHVlID0gaXRlbS5wcmljZSAqIGl0ZW0uYW1vdW50XG4gICAgICAgICAgICBjYXJ0VmFsdWUgKz0gaXRlbVZhbHVlO1xuICAgICAgICAgICAgY2FydFN1bSA9IGNhcnRWYWx1ZSArIGZlZTtcbiAgICAgICAgfSlcbiAgICAgICAganNUb3RhbC5pbm5lckhUTUwgPSBgTlQkICR7Y2FydFZhbHVlfWBcbiAgICAgICAganNGZWUuaW5uZXJIVE1MID0gYE5UJCAke2ZlZX1gXG4gICAgICAgIGpzU3VtLmlubmVySFRNTCA9IGBOVCQgJHtjYXJ0U3VtfWBcbiAgICB9XG5cbiAgICB0aGlzLmNvdW50UmVuZGVyID1mdW5jdGlvbiAoaSl7XG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNqcy12YWx1ZS0ke2l9YCkuaW5uZXJIVE1MID1gTlQkICR7dGhpcy5pdGVtTGlzdFtpXS5hbW91bnQqdGhpcy5pdGVtTGlzdFtpXS5wcmljZX1gXG4gICAgICAgIHRoaXMudXBkYXRlVG90YWwoKTtcbiAgICB9XG5cbiAgICB0aGlzLmNhcnROdW1iZXJSZW5kZXIgPWZ1bmN0aW9uICgpe1xuICAgICAgICBjYXJ0TnVtYmVyLmlubmVySFRNTD1gXG4gICAgICAgIDxzcGFuIGNsYXNzPVwiY2FydC1udW1iZXItc2l6ZSByb3VuZGVkLWNpcmNsZSB3LTUgaC01IHBvc2l0aW9uLWFic29sdXRlIHRleHQtY2VudGVyIHRleHQtcHJpbWFyeSBiZy1zZWNvbmRhcnkgZnotMjRcIj4gXG4gICAgICAgICR7dGhpcy5pdGVtTGlzdC5sZW5ndGh9XG4gICAgICAgICA8L3NwYW4+XG4gICAgICAgICBgXG4gICAgfVxuXG4gICAgdGhpcy5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7IFxuICAgICAgICB0aGlzLmNhcnROdW1iZXJSZW5kZXIoKTtcbiAgICAgICAgbGV0IGNhcnRWYWx1ZSA9IDA7XG4gICAgICAgIGxldCBjYXJ0U3VtID0gMDtcbiAgICAgICAgbGV0IGZlZT0zMDA7XG4gICAgICAgIGxldCBzdHI7XG4gICAgICAgIGxldCBzaHBTdHI7XG4gICAgICAgIHRoaXMuaXRlbUxpc3QuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwgaWR4KSB7XG4gICAgICAgICAgICBjb25zdCBpdGVtVmFsdWUgPSBpdGVtLnByaWNlICogaXRlbS5hbW91bnRcbiAgICAgICAgICAgIGNhcnRWYWx1ZSArPSBpdGVtVmFsdWU7XG4gICAgICAgICAgICBjYXJ0U3VtID0gY2FydFZhbHVlK2ZlZTtcbiAgICAgICAgICAgIGNvbnN0IHRyID1cbiAgICAgICAgYCAgIFxuICAgICAgICAgPGxpIGlkPVwianMtaXRlbS0ke2lkeH1cIiBjbGFzcz1cIiByb3cgZy0wIGNvbC1tZC0xMiBtYi0yIHBiLTIgbXgtMCBweC0wIGJvcmRlci1jYXJ0IGJvcmRlci1zZWNvbmRhcnkgdGV4dC1wcmltYXJ5IGFsaWduLWl0ZW1zLWNlbnRlciAganVzdGlmeS1jb250ZW50LWJldHdlZW4gZmYtcGluZy1mYW5nLXRjLXNlbWlib2xkICBcIj5cbiAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNvbC02IGNvbC1tZC0zIHBsLTBcIj5cbiAgICAgICAgICAgICAgICA8aW1nIHNyYz1cIiR7aXRlbS5pbWdVcmx9XCIgY2xhc3M9XCJjYXJ0LWltZyB3LTEwMCBcIj5cbiAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiIHJvdyBnLTAgY29sLTYgY29sLW1kLTYgZmYtcGluZy1mYW5nLXRjLWxpZ2h0IGFsaWduLWl0ZW1zLWNlbnRlclwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjb2wtbWQtNiBcIj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImZ6LTIwcHhcIj4ke2l0ZW0uaXRlbU5hbWV9PC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJmZi1IZWx2ZXRpY2EtbmV1ZS1yZWd1bGFyIHB5LTJweFwiPk5UJCAke2l0ZW0ucHJpY2V9PC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29sLW1kLTYgZC1mbGV4ICBcIj5cbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiAgZGF0YS1taW51c2VyPVwiJHtpZHh9XCIgY2xhc3M9XCIganMtbWludXNlciAgdy02IGgtNiBmZi1waW5nLWZhbmctdGMtbGlnaHQgYm9yZGVyIGJvcmRlci1yaWdodC0wIHRleHQtY2VudGVyIGJ0bi1hY3RpdmVcIj48aSBjbGFzcz1cImljb24gaWNvbi1taW51cyB0ZXh0LXByaW1hcnkgcG9pbnRlci1ldmVudHMtbm9uZVwiPjwvaT48L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBpZD1cImpzLWNvdW50LSR7aWR4fVwiIGNsYXNzPVwiZC1mbGV4IGp1c3RpZnktY29udGVudC1jZW50ZXIgYWxpZ24taXRlbXMtY2VudGVyIHctNiBoLTYgZmYtcGluZy1mYW5nLXRjLWxpZ2h0IGJvcmRlciBib3JkZXItcmlnaHQtMFwiPiR7aXRlbS5hbW91bnR9PC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDxidXR0b24gIGRhdGEtYWRkZXI9XCIke2lkeH1cIiBjbGFzcz1cIiBqcy1hZGRlciAgdy02IGgtNiBmZi1waW5nLWZhbmctdGMtbGlnaHQgIGJvcmRlciB0ZXh0LWNlbnRlciBidG4tYWN0aXZlXCI+PGkgY2xhc3M9XCJpY29uIGljb24tYWRkIHRleHQtcHJpbWFyeSBwb2ludGVyLWV2ZW50cy1ub25lXCI+PC9pPjwvYnV0dG9uPjwvYnV0dG9uPiBcbiAgICAgICAgICAgICAgICA8L2Rpdj4gICBcbiAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29sLTEyIGNvbC1tZC0zIGQtZmxleCAgcHgtMFwiPiBcbiAgICAgICAgICAgICAgICAgICAgPGRpdiAgaWQ9XCJqcy12YWx1ZS0ke2lkeH1cIiBjbGFzcz1cInByaWNlLWJvcmRlciBjb2wtbWQtMTAgZnotMjBweCBweS0xIGJvcmRlciBib3JkZXItc2Vjb25kYXJ5IGJvcmRlci1yaWdodC0wIGJvcmRlci1sZWZ0LTAgIHRleHQtcmlnaHQgdGV4dC1tZC1sZWZ0IFwiPlxuICAgICAgICAgICAgICAgICAgICBOVCQgJHtpdGVtVmFsdWV9XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPVwianMtYnRuXCIgY2xhc3M9XCJjb2wtbWQtMiBkLW5vbmUgZC1tZC1ibG9jayB0ZXh0LXJpZ2h0IHB4LTFcIiBkYXRhLWJ0bj1cIiR7aWR4fVwiIGRhdGEtcGlkPVwiJHtpdGVtLmlkfVwiID48aW1nIHNyYz1cIi4vaW1nL3RyYXNoLnN2Z1wiIGFsdD1cIlwiY2xhc3M9XCJwb2ludGVyLWV2ZW50cy1ub25lIHctMlwiPlxuICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgIDwvZGl2PiBcbiAgICAgICAgPC9saT5cbiAgICAgICAgYFxuICAgICAgICBjb25zdCBsaXN0PVxuICAgICAgICBgXG4gICAgICAgICAgICAgPGxpIGlkPVwianMtaXRlbS0ke2lkeH1cIiBjbGFzcz1cIiByb3cgZy0wIG14LTAgcHgtMCBjb2wtbWQtMTIgIGFsaWduLWl0ZW1zLWNlbnRlciBmZi1waW5nLWZhbmctdGMtc2VtaWJvbGQgIFwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjb2wtbWQtNiBcIj5cbiAgICAgICAgICAgICAgICAgICAgPGltZyBzcmM9XCIke2l0ZW0uaW1nVXJsfVwiIGNsYXNzPVwiY2FydC1pbWcgdy0xMDAgaC0xMCBweC0yXCI+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIiByb3cgZy0wIGNvbC1tZC02IGZmLXBpbmctZmFuZy10Yy1saWdodCBcIj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJmei0xNnB4XCI+JHtpdGVtLml0ZW1OYW1lfSZuYnNwOyAoJHtpdGVtLmFtb3VudH0pPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGlkPVwianMtdmFsdWUtJHtpZHh9XCIgY2xhc3M9XCJmei0yMHB4IHRleHQtbGVmdFwiPk5UJCAke2l0ZW1WYWx1ZX08L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2xpPlxuICAgICAgICBgO1xuICAgICAgICBzdHI9dHJcbiAgICAgICAgaWYoY2FydExpc3Qpe1xuICAgICAgICAgICAgY2FydExpc3QuaW5uZXJIVE1MKz1zdHI7XG4gICAgICAgIH1cbiAgICAgICAgc2hwU3RyPWxpc3RcbiAgICAgICAgaWYoc2hvcHBpbmdMaXN0KXtcbiAgICAgICAgICAgIHNob3BwaW5nTGlzdC5pbm5lckhUTUwrPXNocFN0cjtcbiAgICAgICAgfVxuICAgICAgXG4gICAgfSk7XG4gICAgICAgIGlmKGNhcnRPcmRlcil7XG4gICAgICAgICAgICBqc1RvdGFsLmlubmVySFRNTCA9YE5UJCAke2NhcnRWYWx1ZX1gXG4gICAgICAgICAgICBqc0ZlZS5pbm5lckhUTUwgPWBOVCQgJHtmZWV9YFxuICAgICAgICAgICAganNTdW0uaW5uZXJIVE1MID1gTlQkICR7Y2FydFN1bX1gIFxuICAgICAgICB9XG4gICAgfVxufVxuaWYocHJvZHVjdFJvdyl7XG4gICAgZmV0Y2goJ2FwaS9kZXNzZXJ0Lmpzb24nKS50aGVuKHJlc3AgPT4gcmVzcC5qc29uKCkpLnRoZW4oKHsgcHJvZHVjdHMgfSkgPT4ge1xuICAgICAgICBwcm9kdWN0c0RhdGEgPSBwcm9kdWN0c1xuICAgICAgICBsZXQgc3RyPVwiIFwiXG4gICAgICAgIHByb2R1Y3RzRGF0YS5mb3JFYWNoKChwcm9kdWN0LGluZGV4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjYXJkID1jcmVhdGVQcm9kdWN0Q2FyZChwcm9kdWN0LGluZGV4KVxuICAgICAgICAgICAgIHN0cis9Y2FyZFxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIGlmKHByb2R1Y3RSb3cpe1xuICAgICAgICAgICAgcHJvZHVjdFJvdy5pbm5lckhUTUw9c3RyOyBcbiAgICAgICAgfVxuXG4gICAgICAgIHByb2R1Y3RSb3cuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICAgICAgaWYoZS50YXJnZXQuZGF0YXNldC5hZGRidG4pe1xuICAgICAgICAgICAgICAgIGNvbnN0IGNhcnRJZD1lLnRhcmdldC5kYXRhc2V0LmNhcnQqMSAgXG4gICAgICAgICAgICAgICAgY2FydC5hZGRJdGVtKGUudGFyZ2V0LmRhdGFzZXQuYWRkYnRuLGNhcnRJZClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7IFxuICAgIH0pO1xufVxuICAgIFxuY29uc3QgY2FydCA9IG5ldyBDYXJ0KCk7XG5jYXJ0LmluaXRDYXJ0KCk7XG4gICAgIFxuaWYoY2FydExpc3QpeyAgICAgICAgXG4gICAgY2FydExpc3QuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICBjb25zdCB0YXJnZXQgPSBlLnRhcmdldFxuICAgICAgICBsZXQgaW5kZXhcbiAgICAgICAgaWYgKHRhcmdldC5tYXRjaGVzKCcuanMtYWRkZXInKSkge1xuICAgICAgICAgICAgaW5kZXggPSB0YXJnZXQuZGF0YXNldC5hZGRlclxuICAgICAgICAgICAgY2FydC5idG5BZGRJdGVtKGluZGV4KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGFyZ2V0Lm1hdGNoZXMoJy5qcy1taW51c2VyJykpIHtcbiAgICAgICAgICAgIGluZGV4ID0gdGFyZ2V0LmRhdGFzZXQubWludXNlclxuICAgICAgICAgICAgY2FydC5idG5NaW51c2VySXRlbShpbmRleCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRhcmdldC5tYXRjaGVzKCcjanMtYnRuJykpIHtcbiAgICAgICAgICAgIGNvbnN0IGlzQ29uZmlybSA9IGNvbmZpcm0oJ+eiuuWumuimgeWIqumZpOWXju+8nycpXG4gICAgICAgICAgICBpbmRleCA9IHRhcmdldC5kYXRhc2V0LmJ0blxuICAgICAgICAgICAgY29uc3QgcGlkID0gdGFyZ2V0LmRhdGFzZXQucGlkKjFcbiAgICAgICAgICAgIGlmIChpc0NvbmZpcm0pIHtcbiAgICAgICAgICAgIGNhcnQuZGVsZXRlSXRlbShpbmRleCxwaWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9ICAgIFxuICAgIH0pXG59ICAgICJdfQ==
